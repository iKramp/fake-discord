DROP TABLE IF EXISTS "messages";
DROP TABLE IF EXISTS "channels";
DROP TABLE IF EXISTS "users";



CREATE TABLE "users" (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    profile_photo TEXT,
    name VARCHAR(255) UNIQUE
);

CREATE TABLE "channels" (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    user_1_id BIGINT REFERENCES "users"(id),
    user_2_id BIGINT REFERENCES "users"(id)
);

CREATE INDEX channel_user_1_id_index ON channels(user_1_id);
CREATE INDEX channel_user_2_id_index ON channels(user_2_id);

CREATE TABLE "messages" (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    user_id BIGINT REFERENCES "users"(id),
    channel_id BIGINT REFERENCES channels(id),
    text TEXT,
    date_created BIGINT
);

CREATE INDEX message_channel_id_index ON messages(channel_id);